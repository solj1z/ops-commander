events {}
http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    server {
        listen 80;
        
        # 1. Serve Dashboard
        location / {
            root /usr/share/nginx/html;
            index index.html;
        }

        # 2. Proxy API (Optimized for SSE)
        location /api/ {
            proxy_pass http://commander-api-svc.ops-commander.svc.cluster.local/api/;
            
            # SSE CRITICAL SETTINGS
            proxy_http_version 1.1;
            proxy_set_header Connection "";
            proxy_buffering off;      # <--- Important: Do not hold data
            proxy_cache off;          # <--- Important: Do not cache stream
            chunked_transfer_encoding off;
            proxy_read_timeout 3600s; # Allow long-lived connections
        }
    }
}
